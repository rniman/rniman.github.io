---
title: DirecX12 | Lecture 11. Depth Stencil View (ì¸í”„ëŸ°)
date: 2025-06-02 23:44:23 +0900
categories: [Study, Study\DirectX]
tags: [DX12, C++, ê°•ì˜ì •ë¦¬, inflearn, Rookiss]
author: "rniman"                            # for single entry
# or
# authors: [<author1_id>, <author2_id>]   # for multiple entries
description: "DirectX12 ê°•ì˜ 11. Depth Stencil Viewë¥¼ ì •ë¦¬í•œ ê¸€ì…ë‹ˆë‹¤."

comments: false # ëŒ“ê¸€ ê¸°ëŠ¥
---

## ê°•ì˜ ì •ë³´ ğŸ“

- ê°•ì˜ëª…: [C++ê³¼ ì–¸ë¦¬ì–¼ë¡œ ë§Œë“œëŠ” MMORPG ê²Œì„ ê°œë°œ ì‹œë¦¬ì¦ˆ - Part2: ê²Œì„ ìˆ˜í•™ê³¼ DirectX12](https://www.inflearn.com/course/%EC%96%B8%EB%A6%AC%EC%96%BC-3d-mmorpg-2)
- í”Œë«í¼: ì¸í”„ëŸ°
- í˜„ì¬ ì„¹ì…˜: Lecture 11 â€“ Depth Stencil View
- ì£¼ìš” ë‚´ìš©: DirectX 12 Z-ë²„í¼ë¥¼ ì‚¬ìš©í•´ í™”ë©´ì— ê·¸ë ¤ì§€ëŠ” í”½ì…€ì˜ ê¹Šì´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê²¹ì¹¨ ì²˜ë¦¬(Z-Buffering) ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.
  
---

### 1. VS ì‰ì´ë” ìœ„ì¹˜ ë³´ì •

- `VS_Main()` ë‚´ë¶€ì—ì„œ ì •ì  ìœ„ì¹˜ì— ì˜¤í”„ì…‹ ì¶”ê°€:

```
output.pos += offset0;
```

---

### 2. ì‚¼ê°í˜• 2ê°œ ë Œë”ë§

- `Game::Update()`ì—ì„œ ë‘ ê°œì˜ ì‚¼ê°í˜•ì„ ë Œë”ë§í•˜ë„ë¡ ìˆ˜ì •í•œë‹¤.
- ì„œë¡œ ë‹¤ë¥¸ Zê°’ì„ ê°€ì§€ë„ë¡ ì„¤ì •í•˜ì—¬ Z-Buffer í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì‘ì—…ì´ë‹¤.

---

### 3. DepthStencilBuffer í´ë˜ìŠ¤ ìƒì„±

- `DepthStencilBuffer` í´ë˜ìŠ¤ë¥¼ ì‘ì„±í•œë‹¤.
- `Engine`ì˜ ë©¤ë²„ë¡œ ë³´ìœ í•˜ê³  `Init()`ì—ì„œ ìƒì„±í•œë‹¤.
- DepthStencil Texture, View ë“±ì„ ê´€ë¦¬í•œë‹¤.

---

### 4. CommandQueueLayer ì„¤ì •

RenderBegin ë‚´ë¶€ ìˆ˜ì •:

```cpp
mCommandList->OMSetRenderTargets(..., &cpuDsvDescriptorHandle, ...);
mCommandList->ClearDepthStencilView(...);
```

- RTVì™€ DSVë¥¼ ë™ì‹œì— ë°”ì¸ë”©
- ë§¤ í”„ë ˆì„ë§ˆë‹¤ DSVë¥¼ Clearí•œë‹¤.

---

### 5. Shader ì„¤ì • ìˆ˜ì •

- íŒŒì´í”„ë¼ì¸ ìƒíƒœ ê°ì²´(PSO)ì— DSV ê´€ë ¨ ì„¤ì • ì¶”ê°€:

```cpp
mPipelineStateDesc.DepthStencilState = CD3DX12_DEPTH_STENCIL_DESC(D3D12_DEFAULT);
mPipelineStateDesc.DSVFormat = dsvFormat;
```

> ê¸°ë³¸ ì„¤ì •ì„ ì‚¬ìš©í•˜ì—¬ ê¹Šì´ í…ŒìŠ¤íŠ¸ í™œì„±í™” ë° ê¹Šì´ ì“°ê¸° ê°€ëŠ¥
> 

---

### ë™ì‘ ì›ë¦¬ ìš”ì•½

- **Zê°’ì´ ë” ì‘ì„ìˆ˜ë¡** ì•ì— ê·¸ë ¤ì§
- GPUëŠ” Zê°’ì„ ë¹„êµí•´ **ê°€ì¥ ê°€ê¹Œìš´ í”½ì…€ë§Œ í™”ë©´ì— í‘œì‹œ**
- Z-Buffer ì´ˆê¸°í™”ëŠ” ë§¤ í”„ë ˆì„ `ClearDepthStencilView()` í˜¸ì¶œë¡œ ìˆ˜í–‰

![Zê°’ì´ ë” ì‘ìœ¼ë©´ ì•ì—ì„œ ê·¸ë ¤ì§„ë‹¤.](assets/img/DX12/01_INFLEARN/08Result.png)

Zê°’ì´ ë” ì‘ìœ¼ë©´ ì•ì—ì„œ ê·¸ë ¤ì§„ë‹¤.

---

## Depth & Stencil ì¶”ê°€ ê°œë… ìš”ì•½ ğŸ§±

### Depth Buffer (Z-Buffer)

- **ê¹Šì´ ê°’(Zê°’)** ì„ ì €ì¥í•˜ëŠ” ë²„í¼ì´ë‹¤.
- **ê°€ì¥ ì•ì— ìˆëŠ” í”½ì…€ë§Œ ê·¸ë¦¬ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤.**
- ê¸°ë³¸ ê·œì¹™: **Zê°’ì´ ì‘ì„ìˆ˜ë¡ ì¹´ë©”ë¼ì— ê°€ê¹ë‹¤.**
- ë™ì‘ ì›ë¦¬:
    1. í”½ì…€ì„ ê·¸ë¦´ ë•Œ Zê°’ì„ ë¹„êµ
    2. ì´ë¯¸ ê·¸ë ¤ì§„ í”½ì…€ì´ ë” ê°€ê¹Œìš°ë©´ ìƒˆ í”½ì…€ì€ ë²„ë¦¼
    3. ë°˜ëŒ€ë¡œ ë” ê°€ê¹Œìš°ë©´ í”½ì…€ì„ ê°±ì‹ í•˜ê³  Zë²„í¼ë„ ì—…ë°ì´íŠ¸

> ğŸ¯ ì£¼ë¡œ ê²¹ì³ì§„ ë¬¼ì²´ì˜ ë Œë”ë§ ìˆœì„œë¥¼ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤.
> 

---

### Stencil Buffer

- **í”½ì…€ë§ˆë‹¤ 8ë¹„íŠ¸ ì •ìˆ˜ ê°’(256)ì„ ì €ì¥**í•  ìˆ˜ ìˆëŠ” ë²„í¼
- ë³µì¡í•œ ë Œë”ë§ íš¨ê³¼ì— ì‚¬ìš©ë˜ëŠ” **ë§ˆìŠ¤í¬** ì—­í• 
- ë™ì‘ ë°©ì‹:
    - íŠ¹ì • ì˜ì—­ì„ ì§€ì •í•˜ê±°ë‚˜ ì œì™¸í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©
    - ì˜ˆ: ë¯¸ë‹ˆë§µ í…Œë‘ë¦¬, í¬íƒˆ, ê·¸ë¦¼ì ì˜ì—­ í•œì • ë Œë”ë§ ë“±

> ğŸ¯ ì¡°ê±´ë¶€ ë Œë”ë§ ì œì–´ì— ì í•© â€” "ì´ ì˜ì—­ë§Œ", "ì´ ì˜ì—­ ì œì™¸í•˜ê³ " ë Œë”ë§!
> 

---

### í•¨ê»˜ ì“°ëŠ” ì´ìœ 

- Depthì™€ Stencilì€ **ê°™ì€ ë¦¬ì†ŒìŠ¤ì— í•¨ê»˜ ì €ì¥**ë˜ë©°,
- DirectX 12ì—ì„œëŠ” ë³´í†µ **DSV(Depth Stencil View)**ë¡œ í†µí•©í•˜ì—¬ ê´€ë¦¬í•©ë‹ˆë‹¤.

---

### ì˜ˆì‹œ: í•œëˆˆì— ë³´ê¸°

| ë²„í¼ ì¢…ë¥˜ | ì—­í•            | ì£¼ìš” ì‚¬ìš© ì˜ˆ                                         |
| --------- | -------------- | ---------------------------------------------------- |
| Depth     | Zê°’ ë¹„êµ       | ê²¹ì³ì§„ ì˜¤ë¸Œì íŠ¸ ì²˜ë¦¬ (ì¹´ë©”ë¼ ê¸°ì¤€)                   |
| Stencil   | ë§ˆìŠ¤í¬ ê°’ ë¹„êµ | UI í´ë¦¬í•‘, ê·¸ë¦¼ì ì œí•œ, í¬ìŠ¤íŠ¸ í”„ë¡œì„¸ì‹± ì˜ì—­ ì œí•œ ë“± |

---

## ìš”ì•½ ë° ëŠë‚€ì  ğŸ“

- Depth Stencil Bufferë¥¼ ì¶”ê°€í•˜ì—¬ ê¹Šì´ ê°’ì— ë”°ë¼ ì•ë’¤ê°€ ì²˜ë¦¬ë˜ë„ë¡ í•˜ì˜€ë‹¤.
> ëŠë‚€ì  ğŸ’¡
> ëìŠ¤-ìŠ¤í…ì‹¤ ë²„í¼ëŠ” ì´í›„ ë‹¤ì–‘í•œ ê·¸ë˜í”½ ê¸°ìˆ , ìµœì í™”ì— í™œìš©ë  ìˆ˜ ìˆëŠ” ë‚´ìš©ì´ê¸° ë•Œë¬¸ì—
> ë‚´ìš©ì€ ì§§ì§€ë§Œ ì˜ ì•Œì•„ ë‘ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.
