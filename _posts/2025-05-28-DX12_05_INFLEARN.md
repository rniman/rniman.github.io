---
title: DirecX12 | Lecture 8. Root Signature (ì¸í”„ëŸ°)
date: 2025-05-28 14:10:23 +0900
categories: [Study, Study\DirectX]
tags: [DX12, C++, ê°•ì˜ì •ë¦¬, inflearn, Rookiss]
author: "rniman"                            # for single entry
# or
# authors: [<author1_id>, <author2_id>]   # for multiple entries
description: "DirectX12 ê°•ì˜ 8. Root Signatureë¥¼ ì •ë¦¬í•œ ê¸€ì…ë‹ˆë‹¤."

comments: false # ëŒ“ê¸€ ê¸°ëŠ¥
---

## ê°•ì˜ ì •ë³´ ğŸ“

- ê°•ì˜ëª…: [C++ê³¼ ì–¸ë¦¬ì–¼ë¡œ ë§Œë“œëŠ” MMORPG ê²Œì„ ê°œë°œ ì‹œë¦¬ì¦ˆ - Part2: ê²Œì„ ìˆ˜í•™ê³¼ DirectX12] (https://www.inflearn.com/course/%EC%96%B8%EB%A6%AC%EC%96%BC-3d-mmorpg-2)
- í”Œë«í¼: ì¸í”„ëŸ°
- í˜„ì¬ ì„¹ì…˜: Lecture 8 â€“ Root Signature
- ì£¼ìš” ë‚´ìš©: DirectX 12 Root Descriptor ë°©ì‹ì—ì„œ **Descriptor Table** ê¸°ë°˜ìœ¼ë¡œ ì „í™˜í•˜ë©°, CBV ê´€ë¦¬ë¥¼ ìœ„í•œ êµ¬ì¡°ë¥¼ ì¬ì„¤ê³„í•œë‹¤.
  
---

### 1. Root Signature êµ¬ì¡° ë³€ê²½

- ê¸°ì¡´: `InitAsConstantBufferView()`
- ë³€ê²½: `InitAsDescriptorTable()`

```cpp
std::array<CD3DX12_DESCRIPTOR_RANGE, 1> descriptorRanges = {
    CD3DX12_DESCRIPTOR_RANGE(D3D12_DESCRIPTOR_RANGE_TYPE_CBV, CBV_REGISTER_COUNT, 0)
};
```

- ê´€ë ¨ enum ë° ìƒìˆ˜ ì •ì˜:

```cpp
enum class CBV_REGISTER_NUMBER {
    b0 = 0, b1, b2, b3, b4, END
};
constexpr UINT CBV_REGISTER_COUNT = static_cast<UINT>(CBV_REGISTER_NUMBER::END);
```

---

### 2. ConstantBuffer ë¦¬íŒ©í† ë§

- CBVìš© ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•˜ê³  **ë””ìŠ¤í¬ë¦½í„° í™ì— Viewë¥¼ ìƒì„±í•œë‹¤.**
- í•µì‹¬ ì ˆì°¨:
    1. `D3D12_DESCRIPTOR_HEAP_DESC` ì„¤ì •
    2. ë””ë°”ì´ìŠ¤ë¥¼ í†µí•´ ë””ìŠ¤í¬ë¦½í„° í™ ìƒì„±
    3. ì‹œì‘ ì£¼ì†Œ/ì¸í¬ë¦¬ë¨¼íŠ¸ ì €ì¥
    4. Viewë¥¼ ë‹¤ìˆ˜ ìƒì„± (ì˜ˆ: 256ê°œ ìŠ¬ë¡¯)
    5. `CreateView()` â†’ `Init()` ë‚´ë¶€ì—ì„œ í˜¸ì¶œ

---

### 3. TableDescriptorHeap í´ë˜ìŠ¤ ë„ì…

- ëª©ì : **CBV/SRV/UAVë¥¼ í…Œì´ë¸” ë‹¨ìœ„ë¡œ ë¬¶ì–´ ê´€ë¦¬**
- ì£¼ìš” ê¸°ëŠ¥:
    - `Init()` : ë””ìŠ¤í¬ë¦½í„° í™ ìƒì„±
    - `Clear()` : ê·¸ë£¹ ì¸ë±ìŠ¤ ì´ˆê¸°í™”
    - `SetCBV()` : CPU í•¸ë“¤ì„ í˜„ì¬ í…Œì´ë¸”ì— ë³µì‚¬
    - `CommitTable()` : GPUì— í…Œì´ë¸” ë°”ì¸ë”©

ğŸ“ ë””ìŠ¤í¬ë¦½í„° í™ êµ¬ì¡° ì˜ˆì‹œ:

```
Shader-visible Descriptor Heap
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Group 0: [CBV0][CBV1][CBV2]...     â”‚
â”‚ Group 1: [CBV0][CBV1][CBV2]...     â”‚
â”‚ Group 2: [CBV0][CBV1][CBV2]...     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 4. ì—”ì§„ êµ¬ì¡° ë°˜ì˜

- `Engine`ì— `TableDescriptorHeap` ì¶”ê°€í•œë‹¤.
- `CommandQueue::RenderBegin()`ì—ì„œ:
    - `Clear()` í˜¸ì¶œ
    - `SetDescriptorHeaps()` í˜¸ì¶œ (í”„ë ˆì„ë‹¹ 1íšŒ ê¶Œì¥)
    - `SetDescriptorHeaps()` ì€ 1ê°œì˜ **CBV/SRV/UAV í™ + 1ê°œì˜ Sampler í™**ë§Œ ë°”ì¸ë”© ê°€ëŠ¥í•˜ë‹¤.

---

### 5. PushData íë¦„ ë³€ê²½

- `PushData()`ëŠ” ì´ì œ `D3D12_CPU_DESCRIPTOR_HANDLE`ì„ ë°˜í™˜í•œë‹¤.
- ë¶ˆí•„ìš”í•œ`SetGraphicsRootConstantBufferView()` ë¥¼ ì œê±°í•œë‹¤.

```cpp
// Mesh.cpp - Render()
D3D12_CPU_DESCRIPTOR_HANDLE handle = constantBuffer->PushData(...);

tableDescriptorHeap->SetCBV(handle, CbvRegisterNumber::b0);
...

tableDescriptorHeap->CommitTable();
```

---

### ì´ìŠˆ ë° íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

- `ConstantBuffer::Init()`ì—ì„œ `CreateView()` í˜¸ì¶œì„ ëˆ„ë½í•˜ì˜€ë‹¤. â†’ **ë Œë”ë§ ì˜¤ë¥˜ ë°œìƒ**
- ì´í›„ Render ì‹œì ì— CBV í…Œì´ë¸” ì—…ë°ì´íŠ¸ ëˆ„ë½ì— ì£¼ì˜í•˜ì.

---

### ì°¸ê³ 

- ë””ìŠ¤í¬ë¦½í„° í…Œì´ë¸” ì „í™˜ ì´ìœ 
    
    
    | í•­ëª©                 | ì„¤ëª…                                                              |
    | -------------------- | ----------------------------------------------------------------- |
    | **Root Descriptor**  | ì†ë„ ë¹ ë¥´ì§€ë§Œ ê°œìˆ˜ ì œí•œ (ìµœëŒ€ 64 DWORD)                           |
    | **Descriptor Table** | í™•ì¥ì„±ê³¼ ìœ ì—°ì„±ì´ ë›°ì–´ë‚¨ (CBV/SRV/UAV ë¬¶ìŒ ì‚¬ìš©)                  |
    | **ì¥ì **             | ì…°ì´ë”ì— í•„ìš”í•œ ìì›ì„ í…Œì´ë¸”ë¡œ ë¬¶ì–´ GPUì— íš¨ìœ¨ì ìœ¼ë¡œ ë°”ì¸ë”© ê°€ëŠ¥ |
- DescriptorHeap ì¢…ë¥˜
    - CBV / SRV / UAVëŠ” ê°™ì€ í™
    - SamplerëŠ” ë³„ë„ í™
    - í•œ ë²ˆì— ë°”ì¸ë”© ê°€ëŠ¥í•œ ë””ìŠ¤í¬ë¦½í„° í™ì€ **ìµœëŒ€ 2ê°œ**

---

## ìš”ì•½ ë° ëŠë‚€ì  ğŸ“

- ë£¨íŠ¸ ì‹œê·¸ë‹ˆì²˜ë¥¼ **ë””ìŠ¤í¬ë¦½í„° í…Œì´ë¸” ê¸°ë°˜ìœ¼ë¡œ ê°œí¸**
- ConstantBufferëŠ” í…Œì´ë¸”ê³¼ ì—°ë™ ê°€ëŠ¥í•œ êµ¬ì¡°ë¡œ ì¬ì„¤ê³„ë˜ì—ˆë‹¤.
- GPUì— ë°”ì¸ë”©í•  CBVë¥¼ ë‹¤ìˆ˜ ê´€ë¦¬í•  ìˆ˜ ìˆë„ë¡ **TableDescriptorHeap** í´ë˜ìŠ¤ê°€ ì‘ì„± ë˜ì—ˆë‹¤.
- `PushData()` â†’ `SetCBV()` â†’ `CommitTable()` ìˆœì„œë¡œ ë Œë”ë§ ë¡œì§ì´ ìˆ˜í–‰ëœë‹¤.
> ëŠë‚€ì  ğŸ’¡
> Root Signatureì™€ Descriptor Tableë‚´ìš©ì„ ì´í›„ í—·ê°ˆë¦¬ì§€ ì•Šê³ ê³ 
> ì˜ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì´í•´í•˜ëŠ” ê²ƒì´ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤ê³  ëŠê¼ˆë‹¤.
